{% block content %}

<h2>Laporan Parkir {{ report.date }}</h2>

<p>Status:
    {% if report.status == 'posted' %}
    <strong style="color:green;">POSTED</strong>
    {% else %}
    <strong style="color:orange;">DRAFT</strong>
    {% endif %}
</p>

<hr>

<h3>Pendapatan</h3>
<table border="1" cellpadding="6">
    <tr>
        <th>Akun Pendapatan</th>
        <th>Seri Awal</th>
        <th>Seri Akhir</th>
        <th>Lembar</th>
        <th>Harga</th>
        <th>Jumlah</th>
        <th>Keterangan</th>
    </tr>
    {% for t in tickets %}
    <tr>
        <td>{{ t.revenue_account.account_name }}</td>
        <td>{{ t.start_serial }}</td>
        <td>{{ t.end_serial }}</td>
        <td>{{ t.lembar|default:"-" }}</td>
        <td>{{ t.price|floatformat:0 }}</td>
        <td>{{ t.subtotal|floatformat:0 }}</td>
        <td>{{ t.description|default:"-" }}</td>
    </tr>
    {% endfor %}
</table>

<h3>Biaya Operasional</h3>
<table border="1" cellpadding="6">
    <tr>
        <th>Akun Biaya</th>
        <th>Keterangan</th>
        <th>Persentase (%)</th>
        <th>Unit</th>
        <th>Nominal</th>
        <th>Jumlah</th>
    </tr>
    {% for e in expenses %}
    <tr>
        <td>{{ e.expense_account.account_name }}</td>
        <td>{{ e.description }}</td>
        <td>{{ e.percentage|default:"-" }}</td>
        <td>{{ e.unit|default:"-" }}</td>
        <td>{{ e.nominal|floatformat:0 }}</td>
        <td>{{ e.amount|floatformat:0 }}</td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="6">Tidak ada biaya</td>
    </tr>
    {% endfor %}
</table>

<hr>

<h3>Ringkasan</h3>
<ul>
    <li>Total Bruto: <strong>{{ total_bruto|floatformat:0 }}</strong></li>
    <li>Total Biaya: <strong>{{ total_expense|floatformat:0 }}</strong></li>
    <li>Kas Bersih: <strong>{{ net_cash|floatformat:0 }}</strong></li>
</ul>

{% if report.status == 'draft' %}
<div style="margin-bottom: 20px;">
    <a href="{% url 'parkir:daily_report_update' report.id %}"
        style="padding: 8px 16px; background-color: #2196F3; color: white; text-decoration: none; border-radius: 4px;">✏️
        Edit Laporan</a>
</div>

<form method="post" action="{% url 'parkir:report_create_journal' report.id %}">
    {% csrf_token %}
    <button type="submit" onclick="return confirm('Buat draft jurnal untuk laporan ini?')">
        BUAT JURNAL
    </button>
</form>
{% else %}
<p>Journal Ref: {{ report.journal_entry_id }}</p>
{% endif %}

<a href="{% url 'parkir:report_list' %}">← Kembali</a>

{% endblock %}